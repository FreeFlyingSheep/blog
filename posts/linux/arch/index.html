<!doctype html><html lang=zh-cn dir=auto><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>安装 Arch Linux | FreeFlyingSheep 的小站</title><meta name=keywords content="Arch Linux"><meta name=description content="根据 Arch Linux Wiki 整理 Arch Linux 的安装。"><meta name=author content="FreeFlyingSheep"><link rel=canonical href=https://freeflyingsheep.github.io/posts/linux/arch/><link crossorigin=anonymous href=/assets/css/stylesheet.min.35cd0f65a15cafa92372b8313deef5960aae04b90ad722f2bbf509eb0468137e.css integrity="sha256-Nc0PZaFcr6kjcrgxPe71lgquBLkK1yLyu/UJ6wRoE34=" rel="preload stylesheet" as=style><link rel=preload href=/avatar.png as=image><script defer crossorigin=anonymous src=/assets/js/highlight.min.7680afc38aa6b15ddf158a4f3780b7b1f7dde7e91d26f073e6229bb7a0793c92.js integrity="sha256-doCvw4qmsV3fFYpPN4C3sffd5+kdJvBz5iKbt6B5PJI=" onload=hljs.initHighlightingOnLoad()></script><link rel=icon href=https://freeflyingsheep.github.io/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://freeflyingsheep.github.io/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://freeflyingsheep.github.io/favicon-32x32.png><link rel=apple-touch-icon href=https://freeflyingsheep.github.io/apple-touch-icon.png><link rel=mask-icon href=https://freeflyingsheep.github.io/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><meta name=generator content="Hugo 0.85.0"><meta property="og:title" content="安装 Arch Linux"><meta property="og:description" content="根据 Arch Linux Wiki 整理 Arch Linux 的安装。"><meta property="og:type" content="article"><meta property="og:url" content="https://freeflyingsheep.github.io/posts/linux/arch/"><meta property="og:image" content="https://freeflyingsheep.github.io/papermod-cover.png"><meta property="article:section" content="posts"><meta property="article:published_time" content="2020-10-20T00:00:00+00:00"><meta property="article:modified_time" content="2020-10-20T00:00:00+00:00"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://freeflyingsheep.github.io/papermod-cover.png"><meta name=twitter:title content="安装 Arch Linux"><meta name=twitter:description content="根据 Arch Linux Wiki 整理 Arch Linux 的安装。"><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Posts","item":"https://freeflyingsheep.github.io/posts/"},{"@type":"ListItem","position":2,"name":"安装 Arch Linux","item":"https://freeflyingsheep.github.io/posts/linux/arch/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"安装 Arch Linux","name":"安装 Arch Linux","description":"根据 Arch Linux Wiki 整理 Arch Linux 的安装。\n","keywords":["Arch Linux"],"articleBody":"根据 Arch Linux Wiki 整理 Arch Linux 的安装。\n安装前准备 参考 Installation guide。\n准备安装介质 从下载页面下载镜像，并从安装介质启动。\n目前我使用的镜像是 archlinux-2020.10.01-x86_64.iso。\n设置键盘布局 我采用默认布局（美式键盘）。\n验证引导模式 1  ls /sys/firmware/efi/efivars   如果该命令没有报错，说明系统是 UEFI 模式引导的，反之是传统方式引导的。\n我的系统是 UEFI 模式引导的。\n连接到网络 我用的是有线连接，使用 ip link 命令可以查看到对应的网卡在列表中，并且已经启用。\n测试 ping archlinux.org 成功。\n更新系统时钟 1  timedatectl set-ntp true   磁盘分区 使用 fdisk -l 查看现在的磁盘分区。\n我需要重新分区，使用 parted 命令，参考 Parted 完成分区：\n parted /dev/sda 进入 parted。 mklabel 设置 gpt 分区类型。 mkpart \"EFI system partition\" fat32 1MiB 301MiB 设置 EFI 分区。 set 1 esp on 设置 EFI 分区标志。 mkpart \"root partition\" ext4 301MiB 102701MiB 设置根分区。 mkpart \"swap partition\" linux-swap 102701MiB 110893MiB 设置交换分区。 mkpart \"home partition\" ext4 110893Mib 100% 设置 /home 分区。 print 确认分区无误，若发现问题，用 rm  删除，再重新用 mkpart 分区。 quit 退出 parted  格式化分区 再次使用 fdisk -l 查看现在的磁盘分区。\n执行以下命令格式化分区：\n1 2 3 4  mkfs.vfat /dev/sda1 mkfs.ext4 /dev/sda2 mkswap /dev/sda3 mkfs.ext4 /dev/sda4   挂载文件系统 挂载根文件系统到 /mnt：\n1  mount /dev/sda2 /mnt   挂载 EFI 分区到 /mnt/boot/efi：\n1 2  mkdir -p /mnt/boot/efi mount /dev/sda1 /mnt/boot/efi   挂载 /home 分区到 /mnt/home：\n1 2  mkdir /mnt/home mount /dev/sda4 /mnt/home   启用交换分区：\n1  swapon /dev/sda3   安装系统 参考 Installation guide。\n选择镜像服务器 执行 vim /etc/pacman.d/mirrorlist 修改镜像列表。\n把中国的站点放到最前面，发现清华站点竟然就在第一个的位置，直接退出即可。\n安装必要的软件包 这里只安装了一些必要的软件包，其余软件包可以稍后安装。\n1  pacstrap /mnt base linux linux-firmware networkmanager vi vim man-db man-pages texinfo   配置系统 配置 fstab 文件 1  genfstab -U /mnt  /mnt/etc/fstab   cat /mnt/etc/fstab 确认文件内容无误。\n进入 Chroot 环境 1  arch-chroot /mnt   配置时区 我需要设置上海时区：\n1 2  ln -sf /usr/share/zoneinfo/Asia/Shanghai /etc/localtime hwclock --systohc   本地化配置 执行 vim /etc/locale.gen 把需要的 locales 前的注释去掉。\n我去掉了 en_US.UTF-8 UTF-8 和 zh_CN.UTF-8 UTF-8 前面的注释。\n执行 locale-gen 生成 locales。\n执行 vim /etc/locale.conf 创建并编辑文件内容为 LANG=en_US.UTF-8。\n注意，默认使用英文，以后我也只在图形界面使用中文，来避免乱码问题。\n网络配置 执行 vim /etc/hostname 创建并编辑文件内容为主机名，我使用的是 loongson。\n执行 vim /etc/hosts 添加相应内容，注意与主机名对应：\n1 2 3  127.0.0.1 localhost ::1 localhost 127.0.1.1 loongson.localdomain loongson   Initramfs 这步可以直接跳过。\n设置 root 密码 1  passwd   安装引导程序 我选择使用 GRUB，参考 GRUB。\n由于我的计算机使用的是 Intel CPU，所以要安装相应的固件 intel-ucode。\n1 2 3  pacman -S intel-ucode grub efibootmgr grub-install --target=x86_64-efi --efi-directory=/boot/efi --bootloader-id=GRUB grub-mkconfig -o /boot/grub/grub.cfg   重启系统 确认上述所有步骤都完成后可以重启。\n1 2  exit reboot   若重启后无法进入系统，除非你能排查问题并修复，否则建议直接重来。\n安装开发环境 启用网络 启用网络并配置：\n1  systemctl start NetworkManager   设置开机启动：\n1  systemctl enable NetworkManager   安装常用软件包 1  pacman -S base-devel zsh gdb git   配置用户 添加用户 参考 Users and groups。\n创建新用户 loongson，配置其登录 shell 为 bash，以后再使用 zsh：\n1  useradd -m -s /bin/bash loongson   为 loongson 配置密码：\n1  passwd loongson   设置管理员权限 将 loongson 添加到 wheel 组：\n1  usermod -a -G wheel loongson   编辑相应的配置文件，删除 # %wheel ALL=(ALL) ALL 一行的注释：\n1  EDITOR=vim visudo   安装图形界面 安装显示驱动 我用的是 Intel 集成显卡：\n1  pacman -S xf86-video-intel mesa   安装显示服务器 我选择使用 Xorg，参考 Xorg。\n1  pacman -S xorg   安装桌面环境 我选择使用 KDE，参考 KDE。\n1  pacman -S plasma kde-applications   设置开机启动：\n1  systemctl enable sddm   重启系统进入图形界面：\n1  reboot   其他操作 下面是可选的其他操作，仅针对 KDE 桌面环境。\n缩放屏幕 我需要修改屏幕缩放到 125%，在 System Settings - Hardware - Display and Monitor - Display Configuration 中设置。\n设置完后先不急着重启，等后续步骤完成再一起重启。\n安装中文字体 参考 Localization (简体中文)/Simplified Chinese (简体中文)。\n打开 Konsole，我选择安装文泉驿中文字体：\n1  pacman -S wqy-microhei wqy-bitmapfont wqy-zenhei   设置图形界面显示中文 修改 System Settings - Personalization - Regional Settings - Language，添加简体中文到顶部（可能显示的是部分乱码，暂时不用管）。\n现在重启计算机，进入桌面后应该是中文环境，且没有乱码，之后可以完成的其他个性化配置。\n添加中国社区源 我选择使用清华源，在 /etc/pacman.conf 中添加以下内容：\n1 2  [archlinuxcn] Server = https://mirrors.tuna.tsinghua.edu.cn/archlinuxcn/$arch   安装密钥：\n1  sudo pacman -S archlinuxcn-keyring   如果出现密钥无法部署的问题，可以参考 https://www.archlinuxcn.org/gnupg-2-1-and-the-pacman-keyring/，进行如下操作：\n1 2 3 4 5 6 7 8  pacman -Syu haveged systemctl start haveged systemctl enable haveged rm -fr /etc/pacman.d/gnupg pacman-key --init pacman-key --populate archlinux pacman-key --populate archlinuxcn   使用 AUR 我选择安装 yay：\n1  sudo pacman -S yay   安装中文输入法 我选择安装搜狗输入法，该输入法在 AUR 中。\n首先，安装 fcitx：\n1  sudo pacman -S fcitx kcm-fcitx   其次，安装搜狗输入法：\n1  yay -S fcitx-sogoupinyin   然后，新建 ~/.pam_environment 并添加以下内容：\n1 2 3  GTK_IM_MODULE DEFAULT=fcitx QT_IM_MODULE DEFAULT=fcitx XMODIFIERS DEFAULT=\\@im=fcitx   最后，注销后重新登录，确认 fcitx 正常启动，右键修改配置，之后重新启动 fcitx，搜狗输入法应该能正常使用。\n美化终端 安装 oh-my-zsh，见 使用 Zsh。\n配置开机动画 参考 Plymouth。\n安装 Plymouth：\n1  sudo pacman -S plymouth   修改 /etc/mkinitcpio.conf：\n1 2 3  MODULES=(i915 ...) ... HOOKS=(base udev plymouth ...)   修改 /etc/default/grub：\n1  GRUB_CMDLINE_LINUX_DEFAULT=\"quiet splash loglevel=3 rd.udev.log_priority=3 vt.global_cursor_default=0\"   重新生成 GRUB 配置文件：\n1  sudo grub-mkconfig -o /boot/grub/grub.cfg   安装 Plymouth 主题：\n1 2  yay -S plymouth-theme-arch-glow sudo plymouth-set-default-theme -R arch-glow   设置平滑过渡：\n1 2  sudo systemctl disable sddm sudo systemctl enable sddm-plymouth   重启计算机查看开机动画。\n配置 GRUB 主题 安装 Vimix 主题。\n重启查看效果。\n","wordCount":"604","inLanguage":"zh-cn","datePublished":"2020-10-20T00:00:00Z","dateModified":"2020-10-20T00:00:00Z","author":{"@type":"Person","name":"FreeFlyingSheep"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://freeflyingsheep.github.io/posts/linux/arch/"},"publisher":{"@type":"Organization","name":"FreeFlyingSheep 的小站","logo":{"@type":"ImageObject","url":"https://freeflyingsheep.github.io/favicon.ico"}}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"&&document.body.classList.add('dark')</script><noscript><style type=text/css>#theme-toggle,.top-link{display:none}</style></noscript><header class=header><nav class=nav><div class=logo><a href=https://freeflyingsheep.github.io/ accesskey=h title="FreeFlyingSheep 的小站 (Alt + H)">FreeFlyingSheep 的小站</a>
<span class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></span></div><ul id=menu><li><a href=https://freeflyingsheep.github.io/archives title=Archive><span>Archive</span></a></li><li><a href=https://freeflyingsheep.github.io/categories title=Categories><span>Categories</span></a></li><li><a href=https://freeflyingsheep.github.io/series title=Series><span>Series</span></a></li><li><a href=https://freeflyingsheep.github.io/tags title=Tags><span>Tags</span></a></li><li><a href=https://freeflyingsheep.github.io/about title=About><span>About</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><div class=breadcrumbs><a href=https://freeflyingsheep.github.io/>Home</a>&nbsp;»&nbsp;<a href=https://freeflyingsheep.github.io/posts/>Posts</a></div><h1 class=post-title>安装 Arch Linux</h1><div class=post-meta>October 20, 2020&nbsp;·&nbsp;3 min&nbsp;·&nbsp;FreeFlyingSheep</div></header><div class=toc><details open><summary accesskey=c title="(Alt + C)"><div class=details>Table of Contents</div></summary><div class=inner><ul><li><a href=#%e5%ae%89%e8%a3%85%e5%89%8d%e5%87%86%e5%a4%87 aria-label=安装前准备>安装前准备</a><ul><li><a href=#%e5%87%86%e5%a4%87%e5%ae%89%e8%a3%85%e4%bb%8b%e8%b4%a8 aria-label=准备安装介质>准备安装介质</a></li><li><a href=#%e8%ae%be%e7%bd%ae%e9%94%ae%e7%9b%98%e5%b8%83%e5%b1%80 aria-label=设置键盘布局>设置键盘布局</a></li><li><a href=#%e9%aa%8c%e8%af%81%e5%bc%95%e5%af%bc%e6%a8%a1%e5%bc%8f aria-label=验证引导模式>验证引导模式</a></li><li><a href=#%e8%bf%9e%e6%8e%a5%e5%88%b0%e7%bd%91%e7%bb%9c aria-label=连接到网络>连接到网络</a></li><li><a href=#%e6%9b%b4%e6%96%b0%e7%b3%bb%e7%bb%9f%e6%97%b6%e9%92%9f aria-label=更新系统时钟>更新系统时钟</a></li><li><a href=#%e7%a3%81%e7%9b%98%e5%88%86%e5%8c%ba aria-label=磁盘分区>磁盘分区</a></li><li><a href=#%e6%a0%bc%e5%bc%8f%e5%8c%96%e5%88%86%e5%8c%ba aria-label=格式化分区>格式化分区</a></li><li><a href=#%e6%8c%82%e8%bd%bd%e6%96%87%e4%bb%b6%e7%b3%bb%e7%bb%9f aria-label=挂载文件系统>挂载文件系统</a></li></ul></li><li><a href=#%e5%ae%89%e8%a3%85%e7%b3%bb%e7%bb%9f aria-label=安装系统>安装系统</a><ul><li><a href=#%e9%80%89%e6%8b%a9%e9%95%9c%e5%83%8f%e6%9c%8d%e5%8a%a1%e5%99%a8 aria-label=选择镜像服务器>选择镜像服务器</a></li><li><a href=#%e5%ae%89%e8%a3%85%e5%bf%85%e8%a6%81%e7%9a%84%e8%bd%af%e4%bb%b6%e5%8c%85 aria-label=安装必要的软件包>安装必要的软件包</a></li><li><a href=#%e9%85%8d%e7%bd%ae%e7%b3%bb%e7%bb%9f aria-label=配置系统>配置系统</a></li><li><a href=#%e9%85%8d%e7%bd%ae-fstab-%e6%96%87%e4%bb%b6 aria-label="配置 fstab 文件">配置 <code>fstab</code> 文件</a></li><li><a href=#%e8%bf%9b%e5%85%a5-chroot-%e7%8e%af%e5%a2%83 aria-label="进入 Chroot 环境">进入 <code>Chroot</code> 环境</a></li><li><a href=#%e9%85%8d%e7%bd%ae%e6%97%b6%e5%8c%ba aria-label=配置时区>配置时区</a></li><li><a href=#%e6%9c%ac%e5%9c%b0%e5%8c%96%e9%85%8d%e7%bd%ae aria-label=本地化配置>本地化配置</a></li><li><a href=#%e7%bd%91%e7%bb%9c%e9%85%8d%e7%bd%ae aria-label=网络配置>网络配置</a></li><li><a href=#initramfs aria-label=Initramfs>Initramfs</a></li><li><a href=#%e8%ae%be%e7%bd%ae-root-%e5%af%86%e7%a0%81 aria-label="设置 root 密码">设置 <code>root</code> 密码</a></li><li><a href=#%e5%ae%89%e8%a3%85%e5%bc%95%e5%af%bc%e7%a8%8b%e5%ba%8f aria-label=安装引导程序>安装引导程序</a></li></ul></li><li><a href=#%e9%87%8d%e5%90%af%e7%b3%bb%e7%bb%9f aria-label=重启系统>重启系统</a></li><li><a href=#%e5%ae%89%e8%a3%85%e5%bc%80%e5%8f%91%e7%8e%af%e5%a2%83 aria-label=安装开发环境>安装开发环境</a><ul><li><a href=#%e5%90%af%e7%94%a8%e7%bd%91%e7%bb%9c aria-label=启用网络>启用网络</a></li><li><a href=#%e5%ae%89%e8%a3%85%e5%b8%b8%e7%94%a8%e8%bd%af%e4%bb%b6%e5%8c%85 aria-label=安装常用软件包>安装常用软件包</a></li></ul></li><li><a href=#%e9%85%8d%e7%bd%ae%e7%94%a8%e6%88%b7 aria-label=配置用户>配置用户</a><ul><li><a href=#%e6%b7%bb%e5%8a%a0%e7%94%a8%e6%88%b7 aria-label=添加用户>添加用户</a></li><li><a href=#%e8%ae%be%e7%bd%ae%e7%ae%a1%e7%90%86%e5%91%98%e6%9d%83%e9%99%90 aria-label=设置管理员权限>设置管理员权限</a></li></ul></li><li><a href=#%e5%ae%89%e8%a3%85%e5%9b%be%e5%bd%a2%e7%95%8c%e9%9d%a2 aria-label=安装图形界面>安装图形界面</a><ul><li><a href=#%e5%ae%89%e8%a3%85%e6%98%be%e7%a4%ba%e9%a9%b1%e5%8a%a8 aria-label=安装显示驱动>安装显示驱动</a></li><li><a href=#%e5%ae%89%e8%a3%85%e6%98%be%e7%a4%ba%e6%9c%8d%e5%8a%a1%e5%99%a8 aria-label=安装显示服务器>安装显示服务器</a></li><li><a href=#%e5%ae%89%e8%a3%85%e6%a1%8c%e9%9d%a2%e7%8e%af%e5%a2%83 aria-label=安装桌面环境>安装桌面环境</a></li></ul></li><li><a href=#%e5%85%b6%e4%bb%96%e6%93%8d%e4%bd%9c aria-label=其他操作>其他操作</a><ul><li><a href=#%e7%bc%a9%e6%94%be%e5%b1%8f%e5%b9%95 aria-label=缩放屏幕>缩放屏幕</a></li><li><a href=#%e5%ae%89%e8%a3%85%e4%b8%ad%e6%96%87%e5%ad%97%e4%bd%93 aria-label=安装中文字体>安装中文字体</a></li><li><a href=#%e8%ae%be%e7%bd%ae%e5%9b%be%e5%bd%a2%e7%95%8c%e9%9d%a2%e6%98%be%e7%a4%ba%e4%b8%ad%e6%96%87 aria-label=设置图形界面显示中文>设置图形界面显示中文</a></li><li><a href=#%e6%b7%bb%e5%8a%a0%e4%b8%ad%e5%9b%bd%e7%a4%be%e5%8c%ba%e6%ba%90 aria-label=添加中国社区源>添加中国社区源</a></li><li><a href=#%e4%bd%bf%e7%94%a8-aur aria-label="使用 AUR">使用 AUR</a></li><li><a href=#%e5%ae%89%e8%a3%85%e4%b8%ad%e6%96%87%e8%be%93%e5%85%a5%e6%b3%95 aria-label=安装中文输入法>安装中文输入法</a></li><li><a href=#%e7%be%8e%e5%8c%96%e7%bb%88%e7%ab%af aria-label=美化终端>美化终端</a></li><li><a href=#%e9%85%8d%e7%bd%ae%e5%bc%80%e6%9c%ba%e5%8a%a8%e7%94%bb aria-label=配置开机动画>配置开机动画</a></li><li><a href=#%e9%85%8d%e7%bd%ae-grub-%e4%b8%bb%e9%a2%98 aria-label="配置 GRUB 主题">配置 GRUB 主题</a></li></ul></li></ul></div></details></div><div class=post-content><p>根据 <a href=https://wiki.archlinux.org/>Arch Linux Wiki</a> 整理 Arch Linux 的安装。</p><h2 id=安装前准备>安装前准备<a hidden class=anchor aria-hidden=true href=#安装前准备>#</a></h2><p>参考 <a href=https://wiki.archlinux.org/index.php/Installation_guide>Installation guide</a>。</p><h3 id=准备安装介质>准备安装介质<a hidden class=anchor aria-hidden=true href=#准备安装介质>#</a></h3><p>从<a href=https://www.archlinux.org/download/>下载页面</a>下载镜像，并从安装介质启动。</p><p>目前我使用的镜像是 <code>archlinux-2020.10.01-x86_64.iso</code>。</p><h3 id=设置键盘布局>设置键盘布局<a hidden class=anchor aria-hidden=true href=#设置键盘布局>#</a></h3><p>我采用默认布局（美式键盘）。</p><h3 id=验证引导模式>验证引导模式<a hidden class=anchor aria-hidden=true href=#验证引导模式>#</a></h3><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">1
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>ls /sys/firmware/efi/efivars
</code></pre></td></tr></table></div></div><p>如果该命令没有报错，说明系统是 UEFI 模式引导的，反之是传统方式引导的。</p><p>我的系统是 UEFI 模式引导的。</p><h3 id=连接到网络>连接到网络<a hidden class=anchor aria-hidden=true href=#连接到网络>#</a></h3><p>我用的是有线连接，使用 <code>ip link</code> 命令可以查看到对应的网卡在列表中，并且已经启用。</p><p>测试 <code>ping archlinux.org</code> 成功。</p><h3 id=更新系统时钟>更新系统时钟<a hidden class=anchor aria-hidden=true href=#更新系统时钟>#</a></h3><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">1
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>timedatectl set-ntp true
</code></pre></td></tr></table></div></div><h3 id=磁盘分区>磁盘分区<a hidden class=anchor aria-hidden=true href=#磁盘分区>#</a></h3><p>使用 <code>fdisk -l</code> 查看现在的磁盘分区。</p><p>我需要重新分区，使用 <code>parted</code> 命令，参考 <a href=https://wiki.archlinux.org/index.php/Parted>Parted</a> 完成分区：</p><ol><li><code>parted /dev/sda</code> 进入 <code>parted</code>。</li><li><code>mklabel</code> 设置 <code>gpt</code> 分区类型。</li><li><code>mkpart "EFI system partition" fat32 1MiB 301MiB</code> 设置 EFI 分区。</li><li><code>set 1 esp on</code> 设置 EFI 分区标志。</li><li><code>mkpart "root partition" ext4 301MiB 102701MiB</code> 设置根分区。</li><li><code>mkpart "swap partition" linux-swap 102701MiB 110893MiB</code> 设置交换分区。</li><li><code>mkpart "home partition" ext4 110893Mib 100%</code> 设置 <code>/home</code> 分区。</li><li><code>print</code> 确认分区无误，若发现问题，用 <code>rm &lt;分区号></code> 删除，再重新用 <code>mkpart</code> 分区。</li><li><code>quit</code> 退出 <code>parted</code></li></ol><h3 id=格式化分区>格式化分区<a hidden class=anchor aria-hidden=true href=#格式化分区>#</a></h3><p>再次使用 <code>fdisk -l</code> 查看现在的磁盘分区。</p><p>执行以下命令格式化分区：</p><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">1
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">2
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">3
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">4
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>mkfs.vfat /dev/sda1
mkfs.ext4 /dev/sda2
mkswap /dev/sda3
mkfs.ext4 /dev/sda4
</code></pre></td></tr></table></div></div><h3 id=挂载文件系统>挂载文件系统<a hidden class=anchor aria-hidden=true href=#挂载文件系统>#</a></h3><p>挂载根文件系统到 <code>/mnt</code>：</p><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">1
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>mount /dev/sda2 /mnt
</code></pre></td></tr></table></div></div><p>挂载 EFI 分区到 <code>/mnt/boot/efi</code>：</p><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">1
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">2
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>mkdir -p /mnt/boot/efi
mount /dev/sda1 /mnt/boot/efi
</code></pre></td></tr></table></div></div><p>挂载 <code>/home</code> 分区到 <code>/mnt/home</code>：</p><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">1
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">2
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>mkdir /mnt/home
mount /dev/sda4 /mnt/home
</code></pre></td></tr></table></div></div><p>启用交换分区：</p><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">1
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>swapon /dev/sda3
</code></pre></td></tr></table></div></div><h2 id=安装系统>安装系统<a hidden class=anchor aria-hidden=true href=#安装系统>#</a></h2><p>参考 <a href=https://wiki.archlinux.org/index.php/Installation_guide>Installation guide</a>。</p><h3 id=选择镜像服务器>选择镜像服务器<a hidden class=anchor aria-hidden=true href=#选择镜像服务器>#</a></h3><p>执行 <code>vim /etc/pacman.d/mirrorlist</code> 修改镜像列表。</p><p>把中国的站点放到最前面，发现清华站点竟然就在第一个的位置，直接退出即可。</p><h3 id=安装必要的软件包>安装必要的软件包<a hidden class=anchor aria-hidden=true href=#安装必要的软件包>#</a></h3><p>这里只安装了一些必要的软件包，其余软件包可以稍后安装。</p><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">1
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>pacstrap /mnt base linux linux-firmware networkmanager vi vim man-db man-pages texinfo
</code></pre></td></tr></table></div></div><h3 id=配置系统>配置系统<a hidden class=anchor aria-hidden=true href=#配置系统>#</a></h3><h3 id=配置-fstab-文件>配置 <code>fstab</code> 文件<a hidden class=anchor aria-hidden=true href=#配置-fstab-文件>#</a></h3><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">1
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>genfstab -U /mnt &gt;&gt; /mnt/etc/fstab
</code></pre></td></tr></table></div></div><p><code>cat /mnt/etc/fstab</code> 确认文件内容无误。</p><h3 id=进入-chroot-环境>进入 <code>Chroot</code> 环境<a hidden class=anchor aria-hidden=true href=#进入-chroot-环境>#</a></h3><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">1
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>arch-chroot /mnt
</code></pre></td></tr></table></div></div><h3 id=配置时区>配置时区<a hidden class=anchor aria-hidden=true href=#配置时区>#</a></h3><p>我需要设置上海时区：</p><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">1
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">2
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>ln -sf /usr/share/zoneinfo/Asia/Shanghai /etc/localtime
hwclock --systohc
</code></pre></td></tr></table></div></div><h3 id=本地化配置>本地化配置<a hidden class=anchor aria-hidden=true href=#本地化配置>#</a></h3><p>执行 <code>vim /etc/locale.gen</code> 把需要的 locales 前的注释去掉。</p><p>我去掉了 <code>en_US.UTF-8 UTF-8</code> 和 <code>zh_CN.UTF-8 UTF-8</code> 前面的注释。</p><p>执行 <code>locale-gen</code> 生成 locales。</p><p>执行 <code>vim /etc/locale.conf</code> 创建并编辑文件内容为 <code>LANG=en_US.UTF-8</code>。</p><p>注意，默认使用英文，以后我也只在图形界面使用中文，来避免乱码问题。</p><h3 id=网络配置>网络配置<a hidden class=anchor aria-hidden=true href=#网络配置>#</a></h3><p>执行 <code>vim /etc/hostname</code> 创建并编辑文件内容为主机名，我使用的是 <code>loongson</code>。</p><p>执行 <code>vim /etc/hosts</code> 添加相应内容，注意与主机名对应：</p><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">1
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">2
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">3
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-text data-lang=text>127.0.0.1        localhost
::1              localhost
127.0.1.1        loongson.localdomain   loongson
</code></pre></td></tr></table></div></div><h3 id=initramfs>Initramfs<a hidden class=anchor aria-hidden=true href=#initramfs>#</a></h3><p>这步可以直接跳过。</p><h3 id=设置-root-密码>设置 <code>root</code> 密码<a hidden class=anchor aria-hidden=true href=#设置-root-密码>#</a></h3><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">1
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>passwd
</code></pre></td></tr></table></div></div><h3 id=安装引导程序>安装引导程序<a hidden class=anchor aria-hidden=true href=#安装引导程序>#</a></h3><p>我选择使用 GRUB，参考 <a href=https://wiki.archlinux.org/index.php/GRUB>GRUB</a>。</p><p>由于我的计算机使用的是 Intel CPU，所以要安装相应的固件 <code>intel-ucode</code>。</p><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">1
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">2
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">3
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>pacman -S intel-ucode grub efibootmgr
grub-install --target<span style=color:#f92672>=</span>x86_64-efi --efi-directory<span style=color:#f92672>=</span>/boot/efi --bootloader-id<span style=color:#f92672>=</span>GRUB
grub-mkconfig -o /boot/grub/grub.cfg
</code></pre></td></tr></table></div></div><h2 id=重启系统>重启系统<a hidden class=anchor aria-hidden=true href=#重启系统>#</a></h2><p>确认上述所有步骤都完成后可以重启。</p><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">1
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">2
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>exit
reboot
</code></pre></td></tr></table></div></div><p>若重启后无法进入系统，除非你能排查问题并修复，否则建议直接重来。</p><h2 id=安装开发环境>安装开发环境<a hidden class=anchor aria-hidden=true href=#安装开发环境>#</a></h2><h3 id=启用网络>启用网络<a hidden class=anchor aria-hidden=true href=#启用网络>#</a></h3><p>启用网络并配置：</p><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">1
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>systemctl start NetworkManager
</code></pre></td></tr></table></div></div><p>设置开机启动：</p><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">1
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>systemctl enable NetworkManager
</code></pre></td></tr></table></div></div><h3 id=安装常用软件包>安装常用软件包<a hidden class=anchor aria-hidden=true href=#安装常用软件包>#</a></h3><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">1
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>pacman -S base-devel zsh gdb git
</code></pre></td></tr></table></div></div><h2 id=配置用户>配置用户<a hidden class=anchor aria-hidden=true href=#配置用户>#</a></h2><h3 id=添加用户>添加用户<a hidden class=anchor aria-hidden=true href=#添加用户>#</a></h3><p>参考 <a href=https://wiki.archlinux.org/index.php/Users_and_groups>Users and groups</a>。</p><p>创建新用户 <code>loongson</code>，配置其登录 shell 为 bash，以后再使用 zsh：</p><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">1
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>useradd -m -s /bin/bash loongson
</code></pre></td></tr></table></div></div><p>为 <code>loongson</code> 配置密码：</p><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">1
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>passwd loongson
</code></pre></td></tr></table></div></div><h3 id=设置管理员权限>设置管理员权限<a hidden class=anchor aria-hidden=true href=#设置管理员权限>#</a></h3><p>将 <code>loongson</code> 添加到 <code>wheel</code> 组：</p><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">1
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>usermod -a -G wheel loongson
</code></pre></td></tr></table></div></div><p>编辑相应的配置文件，删除 <code># %wheel ALL=(ALL) ALL</code> 一行的注释：</p><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">1
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>EDITOR<span style=color:#f92672>=</span>vim visudo
</code></pre></td></tr></table></div></div><h2 id=安装图形界面>安装图形界面<a hidden class=anchor aria-hidden=true href=#安装图形界面>#</a></h2><h3 id=安装显示驱动>安装显示驱动<a hidden class=anchor aria-hidden=true href=#安装显示驱动>#</a></h3><p>我用的是 Intel 集成显卡：</p><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">1
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>pacman -S xf86-video-intel mesa
</code></pre></td></tr></table></div></div><h3 id=安装显示服务器>安装显示服务器<a hidden class=anchor aria-hidden=true href=#安装显示服务器>#</a></h3><p>我选择使用 <code>Xorg</code>，参考 <a href=https://wiki.archlinux.org/index.php/Xorg>Xorg</a>。</p><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">1
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>pacman -S xorg
</code></pre></td></tr></table></div></div><h3 id=安装桌面环境>安装桌面环境<a hidden class=anchor aria-hidden=true href=#安装桌面环境>#</a></h3><p>我选择使用 <code>KDE</code>，参考 <a href=https://wiki.archlinux.org/index.php/KDE>KDE</a>。</p><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">1
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>pacman -S plasma kde-applications
</code></pre></td></tr></table></div></div><p>设置开机启动：</p><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">1
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>systemctl enable sddm
</code></pre></td></tr></table></div></div><p>重启系统进入图形界面：</p><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">1
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>reboot
</code></pre></td></tr></table></div></div><h2 id=其他操作>其他操作<a hidden class=anchor aria-hidden=true href=#其他操作>#</a></h2><p>下面是可选的其他操作，仅针对 KDE 桌面环境。</p><h3 id=缩放屏幕>缩放屏幕<a hidden class=anchor aria-hidden=true href=#缩放屏幕>#</a></h3><p>我需要修改屏幕缩放到 125%，在 <code>System Settings -> Hardware -> Display and Monitor -> Display Configuration</code> 中设置。</p><p>设置完后先不急着重启，等后续步骤完成再一起重启。</p><h3 id=安装中文字体>安装中文字体<a hidden class=anchor aria-hidden=true href=#安装中文字体>#</a></h3><p>参考 <a href=https://wiki.archlinux.org/index.php/Localization_(%E7%AE%80%E4%BD%93%E4%B8%AD%E6%96%87)/Simplified_Chinese_(%E7%AE%80%E4%BD%93%E4%B8%AD%E6%96%87)>Localization (简体中文)/Simplified Chinese (简体中文)</a>。</p><p>打开 <code>Konsole</code>，我选择安装文泉驿中文字体：</p><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">1
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>pacman -S wqy-microhei wqy-bitmapfont wqy-zenhei
</code></pre></td></tr></table></div></div><h3 id=设置图形界面显示中文>设置图形界面显示中文<a hidden class=anchor aria-hidden=true href=#设置图形界面显示中文>#</a></h3><p>修改 <code>System Settings -> Personalization -> Regional Settings -> Language</code>，添加简体中文到顶部（可能显示的是部分乱码，暂时不用管）。</p><p>现在重启计算机，进入桌面后应该是中文环境，且没有乱码，之后可以完成的其他个性化配置。</p><h3 id=添加中国社区源>添加中国社区源<a hidden class=anchor aria-hidden=true href=#添加中国社区源>#</a></h3><p>我选择使用清华源，在 <code>/etc/pacman.conf</code> 中添加以下内容：</p><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">1
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">2
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-text data-lang=text>[archlinuxcn]
Server = https://mirrors.tuna.tsinghua.edu.cn/archlinuxcn/$arch
</code></pre></td></tr></table></div></div><p>安装密钥：</p><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">1
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>sudo pacman -S archlinuxcn-keyring
</code></pre></td></tr></table></div></div><p>如果出现密钥无法部署的问题，可以参考 <a href=https://www.archlinuxcn.org/gnupg-2-1-and-the-pacman-keyring/>https://www.archlinuxcn.org/gnupg-2-1-and-the-pacman-keyring/</a>，进行如下操作：</p><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">1
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">2
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">3
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">4
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">5
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">6
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">7
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">8
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>pacman -Syu haveged
systemctl start haveged
systemctl enable haveged

rm -fr /etc/pacman.d/gnupg
pacman-key --init
pacman-key --populate archlinux
pacman-key --populate archlinuxcn
</code></pre></td></tr></table></div></div><h3 id=使用-aur>使用 AUR<a hidden class=anchor aria-hidden=true href=#使用-aur>#</a></h3><p>我选择安装 yay：</p><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">1
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>sudo pacman -S yay
</code></pre></td></tr></table></div></div><h3 id=安装中文输入法>安装中文输入法<a hidden class=anchor aria-hidden=true href=#安装中文输入法>#</a></h3><p>我选择安装搜狗输入法，该输入法在 AUR 中。</p><p>首先，安装 <code>fcitx</code>：</p><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">1
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>sudo pacman -S fcitx kcm-fcitx
</code></pre></td></tr></table></div></div><p>其次，安装搜狗输入法：</p><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">1
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>yay -S fcitx-sogoupinyin
</code></pre></td></tr></table></div></div><p>然后，新建 <code>~/.pam_environment</code> 并添加以下内容：</p><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">1
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">2
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">3
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-text data-lang=text>GTK_IM_MODULE DEFAULT=fcitx
QT_IM_MODULE  DEFAULT=fcitx
XMODIFIERS    DEFAULT=\@im=fcitx
</code></pre></td></tr></table></div></div><p>最后，注销后重新登录，确认 fcitx 正常启动，右键修改配置，之后重新启动 fcitx，搜狗输入法应该能正常使用。</p><h3 id=美化终端>美化终端<a hidden class=anchor aria-hidden=true href=#美化终端>#</a></h3><p>安装 oh-my-zsh，见 <a href=/posts/tips/zsh>使用 Zsh</a>。</p><h3 id=配置开机动画>配置开机动画<a hidden class=anchor aria-hidden=true href=#配置开机动画>#</a></h3><p>参考 <a href=https://wiki.archlinux.org/index.php/Plymouth>Plymouth</a>。</p><p>安装 Plymouth：</p><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">1
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>sudo pacman -S plymouth
</code></pre></td></tr></table></div></div><p>修改 <code>/etc/mkinitcpio.conf</code>：</p><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">1
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">2
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">3
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-text data-lang=text>MODULES=(i915 ...)
...
HOOKS=(base udev plymouth ...)
</code></pre></td></tr></table></div></div><p>修改 <code>/etc/default/grub</code>：</p><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">1
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-text data-lang=text>GRUB_CMDLINE_LINUX_DEFAULT=&#34;quiet splash loglevel=3 rd.udev.log_priority=3 vt.global_cursor_default=0&#34;
</code></pre></td></tr></table></div></div><p>重新生成 GRUB 配置文件：</p><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">1
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>sudo grub-mkconfig -o /boot/grub/grub.cfg
</code></pre></td></tr></table></div></div><p>安装 Plymouth 主题：</p><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">1
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">2
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>yay -S plymouth-theme-arch-glow
sudo plymouth-set-default-theme -R arch-glow
</code></pre></td></tr></table></div></div><p>设置平滑过渡：</p><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">1
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">2
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>sudo systemctl disable sddm
sudo systemctl enable sddm-plymouth
</code></pre></td></tr></table></div></div><p>重启计算机查看开机动画。</p><h3 id=配置-grub-主题>配置 GRUB 主题<a hidden class=anchor aria-hidden=true href=#配置-grub-主题>#</a></h3><p>安装 <a href=https://github.com/vinceliuice/grub2-themes/>Vimix</a> 主题。</p><p>重启查看效果。</p></div><footer class=post-footer><ul class=post-tags><li><a href=https://freeflyingsheep.github.io/tags/arch-linux/>Arch Linux</a></li></ul><nav class=paginav><a class=prev href=https://freeflyingsheep.github.io/posts/kernel/develop/arch/><span class=title>«</span><br><span>体系结构相关知识</span></a>
<a class=next href=https://freeflyingsheep.github.io/posts/kernel/develop/build/><span class=title>»</span><br><span>内核编译和调试</span></a></nav></footer></article></main><footer class=footer><span>&copy; 2021 <a href=https://freeflyingsheep.github.io/>FreeFlyingSheep 的小站</a></span>
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
        <a href=https://git.io/hugopapermod rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)"><button class=top-link id=top-link type=button accesskey=g><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg></button></a>
<script>let menu=document.getElementById('menu');menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)},document.querySelectorAll('a[href^="#"]').forEach(a=>{a.addEventListener("click",function(b){b.preventDefault();var a=this.getAttribute("href").substr(1);window.matchMedia('(prefers-reduced-motion: reduce)').matches?document.querySelector(`[id='${decodeURIComponent(a)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(a)}']`).scrollIntoView({behavior:"smooth"}),a==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${a}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove('dark'),localStorage.setItem("pref-theme",'light')):(document.body.classList.add('dark'),localStorage.setItem("pref-theme",'dark'))})</script><script>document.querySelectorAll('pre > code').forEach(b=>{const c=b.parentNode.parentNode,a=document.createElement('button');a.classList.add('copy-code'),a.innerText='copy';function d(){a.innerText='copied!',setTimeout(()=>{a.innerText='copy'},2e3)}a.addEventListener('click',e=>{if('clipboard'in navigator){navigator.clipboard.writeText(b.textContent),d();return}const a=document.createRange();a.selectNodeContents(b);const c=window.getSelection();c.removeAllRanges(),c.addRange(a);try{document.execCommand('copy'),d()}catch(a){}c.removeRange(a)}),c.classList.contains("highlight")?c.appendChild(a):c.parentNode.firstChild==c||(b.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?b.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(a):b.parentNode.appendChild(a))})</script></body></html>